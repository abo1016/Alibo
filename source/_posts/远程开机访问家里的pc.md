---
title: 远程开机&访问家里的PC
tags: [远程, pc]
id: '365'
categories:
    - 网络
date: 2018-12-27 10:19:44
---

### 最近搞了个公网ip，想起了现在的电脑都支持WOL(wake on lan)网络唤醒，于是就折腾了一下。

*   公网ip的话，我这边是电信的刚开始也是没有公网ip的，后来联系客服（我是在微信公众号中间联系的，电话应该也是一样）说要一个公网ip，然后客户就派单给了师傅，第二天就好了。
*   由于电信给的公网ip是动态的，就只要超过48小时或者路由器重新拨号ip就变了。所以我们需要ddns域名来解析ip，我使用的是免费的ddns no-ip[官网](https://www.noip.com/ "官网")。
*   no-ip需要使一个动态刷新ip的客户端，linux、windows、mac全平台都支持，而且每个需要一次邮件验证（其实都能接受，毕竟是免费的，使用一段时间感觉效果不错）。

#### 遇到的问题

前提条件：电脑主板必须支持wol，并已经在bios开启此功能,网卡网卡支持网络唤醒，在网卡配置电源管理中勾选以下选项 ![](https://blog.wenboo.top/wp-content/uploads/2018/12/1651a138b5a294a1cd7596bab9966683.png) 1. 最开始尝试着在局域网中进行开机唤醒死活唤醒不了，后来看见网上说可能是防火墙的问题。 在防火墙设置中开放一个端口： 新建一个**入站规则** ![](https://blog.wenboo.top/wp-content/uploads/2018/12/897386590604c95e7d26d2eb078dc436.png) ![](https://blog.wenboo.top/wp-content/uploads/2018/12/a57ed6627604e90edfa711fa2c3e545a.png) **这个端口很重要，需要在路由器中设置端口转发,然后作用域的话全部勾选就好** ![](https://blog.wenboo.top/wp-content/uploads/2018/12/ae615908032c5ae22d86c3c719de4640.png) 通过以上设置后，在局域网内已经能够成功唤醒电脑了。

2.  在广域网唤醒电脑

在广域网中唤醒电脑开机的前提条件： - 公网ip或者内网穿透 - 路由可以静态arp绑定，绑定pc的mac地址和内网ip 现在很多的路由器（我的是腾达垃圾路由ac9）都把静态arp绑定这个功能去掉了，以前的路由器都有。 在路由器web管理页面中没有静态arp绑定的功能，就能只能通过命令的形式登录到路由器上使用linux arp命令来手动绑定（我用的telnet，有些路由器可以直接ssh登录） 登录后执行 `arp -s ip mac` 绑定（这条命令可以加如路由器的开机初始化脚本里面，这样路由器重启之后又会重新绑定）

#### 远程控制

以前一直使用的是teamviewer体验一般，有时候登录都要很久非常卡顿，有时又很流畅，不稳定。有了公网ip后我们就可以使用windows自**远程桌面连接**了 ![](https://blog.wenboo.top/wp-content/uploads/2018/12/c2005d789570ee1f575463623fdcfd01.png) 记得打开路由器端口转发 3389（默认，可以修改）端口 手机端推荐微软自家的RD Client Android和ios都有